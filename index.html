<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XYZ - Registration</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/custom.css">
    <script src="js/jquery.min.js"></script>
    <script src="js/vue.min.js"></script>
    <script src="js/login.js"></script>
    <script src="js/scripts.js"></script>
</head>
<body class="container">
    <h1>Register</h1>
    <div class="center" id="app" v-cloak>
		
		<!-- Login / Register Toggles -->
      <div class="actions">
        <button class="btn-tab font-bold" :class='[{ active: isDisabled("signin"), "color-primary": currentComponent === "signin" }]' @click='setView("signin")'>Sign In
        </button>
        <button class="btn-tab font-bold" :class='[{ active: isDisabled("register"), "color-primary": currentComponent === "register" }]' @click='setView("register")'>Register
        </button>
      </div>
		
		<!-- Screens -->
      <transition name='form' mode='out-in'>
        <keep-alive>
          <component :feedback='feedback' :is="currentComponent" @register-form='handleForm' @signin-form='handleForm'></component>
        </keep-alive>
      </transition>
  
    </div>
  
    <!-- Sign Up  -->
    <template id="signUp">
      <form @submit.prevent='onSubmit' ref='form' action="" class='register-form'>
        <img class="banner" src="/assets_from_client/assets/WSJ_Horizontal.png"/>
        <h2 class="font-bold">New Account</h2>
        <div class="form-group">
          <label for="firstname">First Name</label>
          <input required type="text" v-model.trim='user.firstname' id='firstname' placeholder="first name">
        </div>
        <div class="form-group">
          <label for="lastname">Last Name</label>
          <input required type="text" v-model.trim='user.lastname' id='lastname' placeholder="last name">
        </div>
        <div class="form-group">
          <label for="email">Email</label>
          <input required type="email" v-model.trim='user.email' id='email' placeholder="email">
        </div>
        <div class="form-group">
          <label for="password">Password</label>
          <input required type="password" v-model='user.password' placeholder="password" id='password' v-bind:class="[ user.password.length != 0 && user.password != user.passwordCheck ? 'invalid' : 'valid' ]">
        </div>
        <div class="form-group">
          <label for="passwordcheck">Confirm Password</label>
          <input required type="password" v-model='user.passwordCheck' placeholder="confirm password" id='passwordcheck' v-bind:class="[ user.password != user.passwordCheck ? 'invalid' : 'valid' ]">
        </div>
        <input class="btn-bold font-bold" type="submit" :disabled='!isFormValid' value='Register'>
          <div class="triangle-bottomright"/>
      </form>
    </template>
  
    <!-- Sign In  -->
    <template id="signinIn">
      <form ref='form' @submit.prevent='handleForm' action="" class='signin-form'>
        <img class="banner" src="/assets_from_client/assets/WSJ_Horizontal.png"/>
        <h2 class="font-bold">Sign In</h2>
        <div class="form-group">
          <label for="email">Email</label>
          <input required v-model='user.email' type="email" id='email' placeholder="email">
        </div>
        <div class="form-group">
          <label for="password">Password</label>
          <input required v-model='user.password' type="password" id='password' placeholder="password">
        </div>
        <input class="btn-bold font-bold" :disabled='!isFormValid' type="submit" value="Sign In">
          <div class="triangle-bottomright"/>
      </form>
    </template>

    <!-- View All Posts -->
    <template id="posts">
        <div>
            <ul>
                <li class="posts" v-for="post in posts" key="post.id">
                    <post v-bind:post="post" detailed="false"></post>
                </li>
            </ul>
        </div>
    </template>



    <!-- View Single Post -->
    <template id="post">
        <div v-if="post">
            <h3 class="post-title font-bold">{{post.title}}</h3>
            <div class="post-body">{{post.body}}</div>
            <div class="post-footer">
                <span>Posted by {{post.user.name}} at {{post.created_at}}</span>
                <span v-if="post.comments.length">{{post.comments.length}} comment{{post.comments.length > 1 ? 's' : ''}}</span>
                <span v-else>No comments</span>
            </div>
        </div>
    </template>

    <!-- Create Post  -->
    <template id="createPost">
        <form @submit.prevent='handleSubmit' ref='form' action="">
            <h2 class="font-bold">Create Post</h2>
            <div class="form-group">
                <label for="title">Title</label>
                <input v-model="title" required type="text" id='title' placeholder="Title">
            </div>
            <div class="form-group">
                <label for="body">Body</label>
                <textarea v-model="body" required id='body' placeholder="Let the world know what's on your mind"></textarea>
            </div>
            <input class="btn-bold font-bold" :disabled='!isFormValid' type="submit" value="Create post">
            <div class="triangle-bottomright"/>
        </form>
    </template>

    <!-- Detailed Post  -->
    <template id="viewPost">
       <div class="display-container">
           <post v-bind:post="post" detailed="true"></post>
           <work v-bind:post-id="post ? post.id : ''"></work>
           <div class="comments" v-if="post">
               <div v-for="comment in post.comments" key="comment.id">
                   <comment v-bind:comment="comment"></comment>
               </div>
           </div>
       </div>
    </template>

    <!-- Create Comment -> TODO: figure out how to get it named properly -->
    <template id="work">
        <form @submit.prevent='handleSubmit' ref='form' action="">
            <div class="form-group">
                <textarea v-model="body" required id='body' placeholder="Leave a comment"></textarea>
            </div>
            <input class="btn-bold font-bold" :disabled='!isFormValid' type="submit" value="Add comment">
            <div class="triangle-bottomright"/>
        </form>
    </template>

    <!-- View Comment -->
    <template id="comment">
        <div class="comment">
            <span>{{comment.body}}</span>
            <div class="post-footer">
                <span>Posted by {{comment.user.name}} at {{comment.created_at}}</span>
            </div>
        </div>
    </template>

  
    <!-- Success Message -->
    <template id="loginFeedback">
      <!-- 
        Easter egg! 
        
        When a user has successfully registered or signed up, 
        there is a third feedback screen which is not included
        in the mock ups. Please style these screens so they align 
        with the rest of the designs.
      -->
      <div class="feedback">
        <header>
          <h2>{{ title }}</h2>
        </header>
        <div v-if='feedback.type === "register"'>
          <h3>Welcome <strong>{{ feedback.data | name }}</strong>!</h3>
			    <p>You may now sign in.</p>
          <p>Please check the email address provided - {{feedback.data | email}} - to complete your registration.</p>
        </div>
        <div v-else>
          <p>Logging in...</p>
        </div>
      </div>
    </template>
  </body>
  
</html>